# Traefik Global Configuration
api:
  dashboard: true
  insecure: true  # For development. Set to false in production with authentication.

providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
    network: "scalex-network"

entryPoints:
  web:
    address: ":80"
    http:
      redirections:
        entrypoint:
          to: "websecure"
          scheme: "https"
          permanent: true

  websecure:
    address: ":443"
  # Remove middleware reference as it's causing issues

certificatesResolvers:
  letsencrypt:
    acme:
      email: "renaka@scalex.money"  # âœ… EMAIL UPDATED
      storage: "/acme.json"
      httpChallenge:
        entryPoint: "web"

# Optional: Dynamic configuration for security headers
http:
  middlewares:
    secure-headers:
      headers:
        customRequestHeaders:
          X-Forwarded-Proto: "https"
        referrerPolicy: "strict-origin-when-cross-origin"
        hostsProxyHeaders:
          - "X-Forwarded-Host"
        contentTypeNosniff: true
        browserXssFilter: true
        forceSTSHeader: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000
        frameDeny: true