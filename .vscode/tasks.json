{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Start Infrastructure",
      "type": "shell",
      "command": "docker-compose -f docker-compose.microservices.yml up -d postgres redis",
      "problemMatcher": [],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Start Full Infrastructure",
      "type": "shell",
      "command": "docker-compose -f docker-compose.microservices.yml up -d postgres redis prometheus grafana redis-commander",
      "problemMatcher": [],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Stop Infrastructure",
      "type": "shell",
      "command": "docker-compose -f docker-compose.microservices.yml down",
      "problemMatcher": [],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Install All Dependencies",
      "type": "shell",
      "command": "npm install && cd websocket-service && npm install && cd ../analytics-service && npm install",
      "problemMatcher": [],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Build All Services",
      "type": "shell",
      "command": "npm run build && cd websocket-service && npm run build && cd ../analytics-service && npm run build",
      "problemMatcher": ["$tsc"],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Watch Redis Streams",
      "type": "shell",
      "command": "docker-compose -f docker-compose.microservices.yml exec redis redis-cli --csv MONITOR | grep -E 'X(ADD|READ|ACK)'",
      "problemMatcher": [],
      "group": "none",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "View PostgreSQL Logs",
      "type": "shell",
      "command": "docker-compose -f docker-compose.microservices.yml logs -f postgres",
      "problemMatcher": [],
      "group": "none",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    }
  ]
}